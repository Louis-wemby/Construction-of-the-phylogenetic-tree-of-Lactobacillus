#### This folder contains all applied methods for phylogenetic tree building and results derived from them.

## Contents
* [ANI method](#ANI-method)
* [MEGA](#MEGA)
* [Tree](#Tree)
  
___

## ANI method

A common and helpful tool [pyani](https://github.com/widdowquinn/pyani) was used to calculate ANI (Average Nucleotide Identity) distance between each strain pair, by simply calling the script `average_nucleotide_identity.py`.Output files were saved to **ANI Result**. (Note that `ani_matrix.csv` was converted from `ANI_percentage_identity.tab` using the script `Convert_to_csv.py` ). The newick file of tree was created by script `NJ_circle.py` `UPGMA_circle.py` and `UPGMA_Rectangle.py`.

___

## MEGA
The prosess of tree building with [MEGA](https://www.megasoftware.net/) consists of three steps.

### Filter genes
Since sequences of genes used for tree building must be obtained from all the targeted strains, the genes without any copy (not exist) in a specific strain need filtering by `Filter_genes.py`. The ratio of filtered non-existent genes can be set alternatively based on their frequencies in strain samples.

---

### Select feature genes
With `ANI length` and `gene copy number matrix` of each strain, we compared the differences of these two attributes between every two strains using `Create_Strains_Pair.py`. The script also trains a random forest regression model to return the top feature genes of importance. Before running the script, you need substitute the filtered ratio `N` with a float between 0 to 1.

---

### Extract feature genes
Here we present an example that extracts the sequences of 16S rRNA gene from the annotation files of strain samples in `Extarct_16SrRNA.py`.

___

## Tree

With the help of iTOL(https://itol.embl.de/), we imported the `NJ_tree.nwk` and visualized it as a tree by different shapes.

* `iTOL_config.txt` is the configuration file which annotates the imported datasets.
* `NJ_tree.nwk` is the newick file of tree generated by NJ method.
* `Tree1.png` is the circular tree with a full cover of colored ranges.
* `Tree2.png` is the circular tree with a clade cover of colored ranges.
* `Tree3.png` is the rectangular tree with straight branches.
* `Tree4.png` is the rectangular tree with slanted branches.
* `Tree5.png` is the unrooted tree with a clade cover colored ranges.
* `Tree6.png` is the unrooted tree with a full cover of colored ranges.
